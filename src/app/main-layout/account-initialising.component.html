<!-- MODAL OVERLAY -->
<div class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="account-init-title">
  <div class="modal-card" #modalCard tabindex="0">
    <!-- MODAL HEADER -->
    <div *ngIf="isLoading" class="loading-state">
      <div class="spinner"></div>
      <p>Checking account status...</p>
    </div>

    <ng-container *ngIf="!isLoading">
      <div class="modal-header">
        <h2 id="account-init-title">Account Activation</h2>
        <p>Complete the steps below to activate your insurance account</p>
      </div>

      <!-- ACCORDION COLUMN -->
      <div class="accordion">
        <form [formGroup]="form" (ngSubmit)="onSubmit()">
          <!-- STEP 1: Agreement -->
          <details open>
            <summary>
              <span class="step-number">1</span>
              <h3>
                User Service Agreement
                <small>Review and accept our terms of service.</small>
              </h3>
            </summary>

            <div class="accordion-content">
              <p class="step-intro">
                Please read the following service agreement carefully. You must agree to these terms to proceed.
              </p>
              <div class="usa-box">
                <p>
                  This User Service Agreement (“Agreement”) governs your use of the
                  insurance services provided by the firm. By proceeding, you
                  acknowledge compliance with underwriting, disclosure, and
                  regulatory obligations as required by law.
                </p>
                <p>
                  The firm reserves the right to suspend or terminate coverage in
                  the event of misrepresentation, fraud, or non-compliance.
                </p>
              </div>
              <div class="radio-group">
                <label class="radio-label">
                  <input type="radio" formControlName="usaStatus" [value]="'agreed'" />
                  I agree to the User Service Agreement
                </label>
                <label class="radio-label">
                  <input type="radio" formControlName="usaStatus" [value]="'disagreed'" />
                  I do not agree to the User Service Agreement
                </label>
              </div>
            </div>
          </details>

          <!-- STEP 2: Vehicle Registration -->
          <details>
            <summary>
              <span class="step-number">2</span>
              <h3>
                Vehicle Registration – Basic Information
                <small>Provide essential details about your vehicle.</small>
              </h3>
            </summary>

            <div class="accordion-content">
              <p class="step-intro">
                Enter the make, model, and other basic information for the vehicle you wish to insure.
              </p>
              <div class="grid-2">
                <div class="field">
                  <label>Vehicle Make</label>
                  <input type="text" formControlName="vehicleMake" />
                </div>

                <div class="field">
                  <label>Vehicle Class</label>
                  <input type="text" formControlName="vehicleClass" />
                </div>

                <div class="field">
                  <label>Number Plate</label>
                  <input type="text" formControlName="numberPlate" />
                </div>

                <div class="field">
                  <label>Year</label>
                  <input type="number" formControlName="year" />
                </div>

                <div class="field">
                  <label>Body Type</label>
                  <select formControlName="bodyType">
                    <option value="">Select</option>
                    <option>Sedan</option>
                    <option>SUV</option>
                    <option>Hatchback</option>
                  </select>
                </div>

                <div class="field">
                  <label>Garaging Address</label>
                  <input type="text" formControlName="garagingAddress" />
                </div>

                <div class="field">
                  <label>VIN</label>
                  <input type="text" formControlName="vin" />
                </div>

                <div class="field">
                  <label>Primary Use</label>
                  <select formControlName="primaryUse">
                    <option value="">Select</option>
                    <option>Commuting</option>
                    <option>Business</option>
                    <option>Pleasure</option>
                    <option>Goods Transport</option>
                  </select>
                </div>
              </div>
            </div>
          </details>

          <!-- MODAL FOOTER -->
          <div class="modal-footer">
            <button type="button" class="btn-secondary" (click)="onClose()" [disabled]="submitting">Cancel</button>
            <button type="submit" class="btn-primary" [disabled]="submitting">{{ submitting ? 'Submitting...' : 'Submit
              for Activation' }}</button>
          </div>
        </form>
      </div>
    </ng-container>
  </div>
</div>